var KEY_TAB=9,KEY_RETURN=13,KEY_ESC=27,KEY_UP=38,KEY_DOWN=40,KEY_SPACE=32,PrettySelector={oSelect:!1,oReplaced:!1,oToggler:!1,oTogglerDown:"icon-sel-down",oTogglerUp:"icon-sel-up",container:'<div class="search-in-replaced" aria-hidden="true"><span role="button" class="search-in-toggle" tabindex="0" aria-label="Expand search-in menu"><span class="icon-sel-down"></span></span><ul data-expanded="false" aria-labelledby="keywords-in"></ul></div>',option:'<li role="button" data-section-id="0" data-option-value="all" data-selected="" tabindex="-1">Search All</li>',init:function(e){that=this,this.oSelect=$(e),this.oSelect.after($(this.container)),this.oReplaced=$(".search-in-replaced"),this.oToggler=$(".search-in-toggle"),this.oSelect.find("option").each(function(e){$(this).attr("data-section-id",e),$(".search-in-replaced").find("ul").append($(that.option).attr("data-section-id",e).attr("data-option-value",$(this).val()).attr("data-selected",$(this).is(":selected")).html($(this).html()))}),this.replaceSelectMenu(),this.handleDropDown(),this.setSelectedStatus()},replaceSelectMenu:function(){this.oSelect.hide(),this.oReplaced.show()},handleDropDown:function(){var e=this;this.oToggler.on("click keydown",function(t){switch(t.which){case KEY_TAB:break;case KEY_RETURN:return t.stopPropagation(),$(this).closest("form").submit();default:return t.stopPropagation(),"true"==e.oToggler.next().attr("data-expanded")?e.collapseReplacedMenu():e.expandReplacedMenu()}}),this.oReplaced.find("li").on("click",function(t){t.stopPropagation(),"true"==e.oToggler.next().attr("data-expanded")&&e.setSelectedStatus($(this).attr("data-section-id")),e.oToggler.trigger("click")}),this.oSelect.on("change",function(){e.setSelectedStatus()})},expandReplacedMenu:function(){var e=this;this.oToggler.next().attr("data-expanded",!0),this.oToggler.find("span").removeClass(this.oTogglerDown).addClass(this.oTogglerUp),liToFocus=this.oToggler.next().addClass("open").find("li:first"),this.oToggler.next().find("[data-selected=true]").length&&(liToFocus=this.oToggler.next().find("[data-selected=true]")),liToFocus.focus(),this.oToggler.next().off("keydown").on("keydown",function(t){switch(f=e.oToggler.next().find("li:focus"),l=e.oToggler.next().find("li").length,t.which){case KEY_DOWN:e.moveFocusDown(t,f,l);break;case KEY_UP:e.moveFocusUp(t,f,l);break;case KEY_SPACE:t.preventDefault();case KEY_RETURN:select_section_id=f.attr("data-section-id"),e.setSelectedStatus(select_section_id),e.collapseReplacedMenu();case KEY_ESC:e.collapseReplacedMenu();break;case KEY_TAB:t.preventDefault()}})},collapseReplacedMenu:function(){this.oToggler.next().removeClass("open"),this.oToggler.next().attr("data-expanded",!1),this.oToggler.find("span").removeClass(this.oTogglerUp).addClass(this.oTogglerDown),this.oToggler.focus()},setSelectedStatus:function(e){oVal=this.oSelect.val(),e||(e=this.oSelect.find("option:selected").attr("data-section-id")),e||(e=this.oSelect.find("option:first").attr("data-section-id")),this.oReplaced.find("ul li").attr("data-selected",!1),this.oSelect.find("option").removeAttr("selected").prop("selected",!1),this.oReplaced.find("li[data-section-id="+e+"]").focus().attr("data-selected",!0),sectionId=this.oReplaced.find("ul li[data-selected=true]").attr("data-section-id"),nVal=this.oSelect.find('option[data-section-id="'+sectionId+'"]').attr("selected","selected").prop("selected",!0).val(),this.oSelect.val(nVal),oVal!==nVal&&this.oSelect.trigger("change")},moveFocusDown:function(e,t,o){e.preventDefault(),this.oToggler.next().find("li").index(t)>=o-1||t.next().focus()},moveFocusUp:function(e,t){e.preventDefault(),this.oToggler.next().find("li").index(t)<=0||t.prev().focus()}};